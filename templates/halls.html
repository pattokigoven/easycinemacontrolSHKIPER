<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ª–∞–º–∏ - Barco ICMP</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='halls.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <h1>üé¨ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∏–Ω–æ–∑–∞–ª–∞–º–∏</h1>
                <div class="admin-info">
                    <span class="admin-name">üë§ {{ admin_name }}</span>
                    <button class="btn btn-logout" onclick="logout()">üö™ –í—ã—Ö–æ–¥</button>
                </div>
            </div>
            <div class="hall-selector">
                <label for="hall-select">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ª:</label>
                <select id="hall-select" class="hall-select" onchange="selectHall()">
                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ª --</option>
                    {% for hall in halls %}
                    <option value="{{ hall.id }}" data-ip="{{ hall.ip }}" data-port="{{ hall.port }}">{{ hall.name }} ({{ hall.ip }})</option>
                    {% endfor %}
                </select>
            </div>
        </header>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–ª–∞ -->
        <div id="hall-container" class="hall-container" style="display: none;">
            <div class="hall-card" id="active-hall-card">
                <div class="hall-header">
                    <h2 id="active-hall-name">–ó–∞–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</h2>
                    <div class="hall-status">
                        <span class="status-indicator offline" id="status-indicator">‚óè</span>
                        <span class="status-text" id="status-text">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ</span>
                    </div>
                </div>

                <div class="hall-info">
                    <span id="active-hall-info"></span>
                </div>

                <div class="hall-controls">
                    <!-- –ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ–∞–Ω—Å -->
                    <button class="btn btn-shutdown" id="shutdown-btn" 
                            onclick="shutdownSession()" disabled>
                        üõë –ó–ê–í–ï–†–®–ò–¢–¨ –°–ï–ê–ù–°
                    </button>

                    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–º -->
                    <div class="control-section">
                        <h3>üîä –ó–≤—É–∫</h3>
                        <div class="volume-controls">
                            <div class="volume-slider-container">
                                <input type="range" class="volume-slider" 
                                       id="volume-slider" 
                                       min="0" max="55" value="40" step="2"
                                       oninput="updateVolumeDisplay(this.value)"
                                       onchange="setVolume(this.value)"
                                       disabled>
                                <span class="volume-value" id="volume-value">4.0</span>
                            </div>
                            <div class="volume-presets">
                                <button class="btn btn-volume" onclick="setVolumePreset(0)" disabled>üîá</button>
                                <button class="btn btn-volume" onclick="setVolumePreset(30)" disabled>3</button>
                                <button class="btn btn-volume" onclick="setVolumePreset(40)" disabled>4</button>
                                <button class="btn btn-volume" onclick="setVolumePreset(50)" disabled>5</button>
                                <button class="btn btn-volume" onclick="setVolumePreset(55)" disabled>5.5</button>
                            </div>
                        </div>
                    </div>

                    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–µ—Ç–æ–º -->
                    <div class="control-section">
                        <h3>üí° –°–≤–µ—Ç</h3>
                        <div class="light-controls">
                            <button class="btn btn-light-on" 
                                    onclick="sendLightCommand('on')" disabled>
                                –í–ö–õ
                            </button>
                            <button class="btn btn-light-off" 
                                    onclick="sendLightCommand('off')" disabled>
                                –í–´–ö–õ
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –ú–∏–Ω–∏-–ª–æ–≥ -->
                <div class="hall-log" id="hall-log">
                    <div class="log-entry info">[--:--:--] –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ª...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è -->
    <div id="confirm-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h2>
            <p id="modal-message">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ–∞–Ω—Å?</p>
            <div class="modal-details">
                <p>–ë—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:</p>
                <ul>
                    <li>–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–∏–ª—å–º–∞</li>
                    <li>–í—ã–∫–ª—é—á–µ–Ω–∏–µ –ª–∞–º–ø—ã</li>
                    <li>–û—á–∏—Å—Ç–∫–∞ –ø–ª–µ–µ—Ä–∞</li>
                    <li>–í–∫–ª—é—á–µ–Ω–∏–µ —Å–≤–µ—Ç–∞ –≤ –∑–∞–ª–µ</li>
                </ul>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-danger" id="modal-confirm">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                <button class="btn btn-secondary" id="modal-cancel">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='halls.js') }}"></script>
</body>
</html>
